<script setup lang="ts">
definePage({
  name: 'api-reference',
  style: {
    navigationBarTitleText: 'API å‚è€ƒ',
  },
})

const router = useRouter()
const route = useRoute()

const currentPath = computed(() => route.path)

function goBack() {
  router.back()
}

function demoPush() {
  router.push('/subPages/router/essentials-navigation')
}

function demoPushTab() {
  router.pushTab('/pages/index/index')
}

function demoReplace() {
  router.replace('/subPages/router/essentials-navigation')
}

function demoReplaceAll() {
  router.replaceAll('/pages/index/index')
}

function demoBack() {
  router.back()
}

function demoBackAdvanced() {
  router.push('/subPages/router/api-reference-back')
}

function copyCode(code: string) {
  uni.setClipboardData({
    data: code,
    showToast: false,
    success: () => {
      uni.hideToast()
      uni.showToast({
        title: 'ä»£ç å·²å¤åˆ¶',
        icon: 'success',
      })
    },
  })
}
</script>

<template>
  <view class="min-h-screen bg-gray-100 py-3 dark:bg-[var(--wot-dark-background)]">
    <view class="mx-3 mb-3">
      <view class="rounded-3 bg-white px-5 py-6 text-center dark:bg-[var(--wot-dark-background2)]">
        <view class="mb-3 text-10">
          ğŸ“–
        </view>
        <view class="mb-2 text-6 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
          API å‚è€ƒ
        </view>
        <view class="text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
          @wot-ui/router å®Œæ•´ API æ–‡æ¡£
        </view>
      </view>
    </view>

    <demo-block title="Hooks" transparent>
      <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
        <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
          useRoute (å“åº”å¼)
        </view>
        <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
          å½“å‰è·¯ç”±è·¯å¾„ (computed): {{ currentPath }}
        </view>
        <view class="mb-3 border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode('const route = useRoute()\nconst currentPath = computed(() => route.path)')">
          <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
            const route = useRoute()
            const currentPath = computed(() => route.path)
          </text>
        </view>
      </view>
    </demo-block>

    <demo-block title="Router æ–¹æ³•" transparent>
      <view class="space-y-3">
        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            push
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            ä¿ç•™å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢ï¼Œç›¸å½“äº uni.navigateTo()
          </view>
          <view class="mb-3 border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode('router.push(target)')">
            <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
              router.push(target)
            </text>
          </view>
          <wd-button type="primary" block @click="demoPush">
            æ¼”ç¤º push
          </wd-button>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            pushTab
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            è·³è½¬åˆ° tabBar é¡µé¢ï¼Œå¹¶å…³é—­å…¶ä»–æ‰€æœ‰é tabBar é¡µé¢ï¼Œç›¸å½“äº uni.switchTab()
          </view>
          <view class="mb-3 border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode('router.pushTab(target)')">
            <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
              router.pushTab(target)
            </text>
          </view>
          <wd-button type="success" block @click="demoPushTab">
            æ¼”ç¤º pushTab
          </wd-button>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            replace
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            å…³é—­å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢ï¼Œç›¸å½“äº uni.redirectTo()
          </view>
          <view class="mb-3 border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode('router.replace(target)')">
            <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
              router.replace(target)
            </text>
          </view>
          <wd-button type="warning" block @click="demoReplace">
            æ¼”ç¤º replace
          </wd-button>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            replaceAll
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            å…³é—­æ‰€æœ‰é¡µé¢ï¼Œæ‰“å¼€åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢ï¼Œç›¸å½“äº uni.reLaunch()
          </view>
          <view class="mb-3 border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode('router.replaceAll(target)')">
            <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
              router.replaceAll(target)
            </text>
          </view>
          <wd-button type="error" block @click="demoReplaceAll">
            æ¼”ç¤º replaceAll
          </wd-button>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            back
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            å…³é—­å½“å‰é¡µé¢ï¼Œè¿”å›ä¸Šä¸€é¡µé¢æˆ–å¤šçº§é¡µé¢ï¼Œç›¸å½“äº uni.navigateBack()
          </view>
          <view class="mb-3 space-y-2">
            <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode('router.back()')">
              <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
                router.back()
              </text>
            </view>
            <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode('router.back({ delta: 2 })')">
              <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
                router.back({ delta: 2 })
              </text>
            </view>
          </view>
          <view class="grid grid-cols-2 gap-2">
            <wd-button type="info" @click="demoBack">
              åŸºç¡€ back
            </wd-button>
            <wd-button type="info" @click="demoBackAdvanced">
              é«˜çº§ back
            </wd-button>
          </view>
        </view>
      </view>
    </demo-block>

    <demo-block title="å¯¼èˆªå®ˆå«" transparent>
      <view class="space-y-3">
        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            beforeEach
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            å…¨å±€å‰ç½®å®ˆå«ï¼Œåœ¨å¯¼èˆªè§¦å‘å‰æ‰§è¡Œ
          </view>
          <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode(&quot;router.beforeEach((to, from, next) => { next() })&quot;)">
            <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
              router.beforeEach((to, from, next) => { next() })
            </text>
          </view>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            afterEach
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            å…¨å±€åç½®é’©å­ï¼Œåœ¨å¯¼èˆªæˆåŠŸå®Œæˆåæ‰§è¡Œ
          </view>
          <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]" @click="copyCode(&quot;router.afterEach((to, from) => { console.log(to) })&quot;)">
            <text class="text-3 text-gray-700 font-mono dark:text-[var(--wot-dark-color)]">
              router.afterEach((to, from) => { console.log(to) })
            </text>
          </view>
        </view>
      </view>
    </demo-block>

    <demo-block title="ç±»å‹å®šä¹‰" transparent>
      <view class="space-y-3">
        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            RouteLocationRaw
          </view>
          <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]">
            <text class="text-3 text-gray-700 leading-relaxed font-mono dark:text-[var(--wot-dark-color)]">
              type RouteLocationRaw = string | RouteLocationPath | RouteLocationNameRaw

              interface RouteLocationPath {
              path: string
              query?: LocationQuery
              }

              interface RouteLocationNameRaw {
              name: string
              params?: RouteParams
              query?: LocationQuery
              }
            </text>
          </view>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            RouterBackRaw
          </view>
          <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]">
            <text class="text-3 text-gray-700 leading-relaxed font-mono dark:text-[var(--wot-dark-color)]">
              type RouterBackRaw = number | RouteBackLocation

              interface RouteBackLocation {
              delta?: number
              url?: string
              animationType?: AnimationType
              animationDuration?: number
              }
            </text>
          </view>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            NavigationGuard
          </view>
          <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]">
            <text class="text-3 text-gray-700 leading-relaxed font-mono dark:text-[var(--wot-dark-color)]">
              type NavigationGuard = (
              to: RouteLocationNormalized,
              from: RouteLocationNormalized,
              next: NavigationGuardNext
              ) => NavigationGuardReturn

              type NavigationGuardReturn = void | boolean | RouteLocationRaw
            </text>
          </view>
        </view>
      </view>
    </demo-block>

    <demo-block title="å¯¼èˆª" transparent>
      <wd-button type="warning" block @click="goBack">
        è¿”å›ä¸Šä¸€é¡µ
      </wd-button>
    </demo-block>
  </view>
</template>
